# ADR-000: Adopt Modular Workspace Architecture

- **Status**: Proposed
- **Date**: 2024-07-08
- **Deciders**: MRF Refactor Working Group
- **Tags**: architecture, tooling, workspaces

## Context
The current Create React App project concentrates all UI, domain logic, configuration, and mock integrations inside a single package (`src/`). Business rules and data access live together in `WOMaterialsService`, making it difficult to tease apart responsibilities. Upcoming requirements demand:

- A config-first platform where every rule can be toggled via JSON.
- Shared domain logic (state machines, validation) across UI and API layers.
- Integration adapters (SharePoint, message bus, webhook) with swap-in implementations.
- Comprehensive testing support (unit, contract, integration, E2E).

Staying with a monolithic CRA folder inhibits these goals and complicates future backend/API introduction.

## Decision
We will restructure the repository into a modular workspace managed by **npm workspaces** while keeping compatibility with existing tooling. The workspace will introduce top-level folders for apps (`/apps/web`, `/apps/api`) and packages (`/packages/config`, `/packages/domain`, `/packages/ui`, `/packages/integrations`, `/packages/testing`) plus `/docs` for living documentation.

Key aspects:
- `package.json` will be updated to declare workspaces and reference sub-packages.
- Shared libraries expose only public APIs (compiled TypeScript) to prevent deep relative imports.
- Existing CRA app will be migrated into `/apps/web`; the dev server/build commands will be proxied through workspace scripts to maintain the current DX.
- Feature flags will ensure partially migrated functionality can be toggled without breaking production.

## Consequences
- **Positive**: Clear separation of concerns, easier to enforce configuration-driven logic, scalable for backend/API addition, shared test utilities, and improved maintainability.
- **Positive**: Enables incremental migrationâ€”packages can be introduced one by one without blocking the app.
- **Negative**: Requires retooling build/test pipelines, CI scripts, and documentation. Contributors must learn the workspace layout.
- **Negative**: Short-term complexity increases while scaffolding packaging, TypeScript project references, and dependency boundaries.

We will revisit this ADR after the workspace scaffolding PR to confirm feasibility and adjust if necessary.
